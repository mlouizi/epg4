/*! JsRender v1.0pre: http://github.com/BorisMoore/jsrender */
/*
* Optimized version of jQuery Templates, for rendering to string.
* Does not require jQuery, or HTML DOM
* Integrates with JsViews (http://github.com/BorisMoore/jsviews)
* Copyright 2012, Boris Moore
* Released under the MIT License.
*/
this.jsviews||this.jQuery&&jQuery.views||function(n,t){var c=",",i="";function it(n){this.name="JsRender Error",this.message=n||"JsRender error"}function ot(n,t){var i="\\";return(!e.rTag||arguments.length)&&(p=n?i+n.charAt(0):p,b=n?i+n.charAt(1):b,s=t?i+t.charAt(0):s,a=t?i+t.charAt(0):a,e.rTag=g="(?:(?:(\\w+(?=[\\/\\s"+s+"]))|(?:(\\w+)?(:)|(>)|(\\*)))\\s*((?:[^"+s+"]|"+s+"(?!"+a+"))*?)",g=new RegExp(p+b+g+"(\\/)?|(?:\\/(\\w+)))"+s+a,"g"),et=new RegExp("<.*>|([^\\\\]|^)[{}]|"+p+b+".*"+s+a)),[p,b,s,a]}function ri(n){var i=this,r=i.tmpl.helpers||{};return n=(i.ctx[n]!==t?i.ctx:r[n]!==t?r:v[n]!==t?v:{})[n],typeof n!="function"?n:function(){return n.apply(i,arguments)}}function ui(n,t,i,r){var u=i.converters;return u=u&&u[n]||d[n],u?u.call(t,r):(l("Unknown converter: {{"+n+":"),r)}function fi(n,u,f,e,s,h){var a,p=f.tags,w=f.templates,y=h.props=h.props||{},c=y.tmpl,b=arguments.length>6?si.call(arguments,6):[],v=p&&p[n]||nt[n];return v?(c&&delete y.tmpl,s=s&&f.tmpls[s-1],c=c||s||t,h.tmpl=i+c===c?w&&w[c]||o[c]||o(c):c,h.isTag=r,h.converter=e,h.view=u,h.renderContent=ft,a=v.apply(h,b),a||(a==t?i:a.toString())):(l("Unknown tag: {{"+n+"}}"),i)}function k(n,i,r,u,f,e,o,s){var c,h={tmpl:f,path:i,parent:r,data:u,ctx:n,views:s?[]:{},_useKey:s?0:1,_hlp:ri,_onRender:o};return r&&(c=r.views,r._useKey?(c[h.key="_"+r._useKey++]=h,h.index=r.index):c.splice(h.key=h.index=e!==t?e:c.length,0,h)),h}function tt(n,r,u,f,e){var o,s;if(u&&typeof u=="object"&&!u.nodeType){for(o in u)r(o,u[o]);return n}return u&&f!==t?i+u===u&&(f===null?delete r[u]:(f=e?e(u,f):f)&&(r[u]=f)):e&&(f=e(t,f||u)),(s=at.onStoreItem)&&s(r,u,f,e),f}function o(n,t){return tt(this,o,n,t,ut)}function nt(n,t){return tt(this,nt,n,t)}function v(n,t){return tt(this,v,n,t)}function d(n,t){return tt(this,d,n,t)}function ft(n,s,c,a,y,p,w){var tt,st,ft,g,et,nt,b,it,ot,rt,d=this,ut=i;if(a===r&&(ot=r,a=0),d.isTag?(b=d.tmpl,(s||d.ctx)&&(rt={},d.ctx&&u(rt,d.ctx),s&&u(rt,s)),s=rt,it=d.props,it&&it.link===h&&(s=s||{},s.link=h),c=c||d.view,p=p||d.path,a=a||d.key):b=d.jquery&&(d[0]||l('Unknown template: "'+d.selector+'"'))||d,b&&(c?(nt=c.ctx,n===c&&(n=c.data,y=r),w=w||c._onRender):nt=v,s=s&&s!==nt?u(u({},nt),s):nt,b.fn||(b=o[b]||o(b)),b)){if(w=s.link!==h&&w,f.isArray(n)&&!y)for(g=ot?c:a!==t&&c||k(s,p,c,n,b,a,w,r),tt=0,st=n.length;tt<st;tt++)ft=n[tt],et=b.fn(ft,k(s,p,g,ft,b,(a||0)+tt,w),e),ut+=w?w(et,b,it):et;else g=ot?c:k(s,p,c,n,b,a,w),g._onRender=w,ut+=b.fn(n,g,e);return w?w(ut,b,it,g.key,p):ut}return l("No template found"),i}function l(n){if(e.debugMode)throw new e.Error(n);}function y(n){l("Syntax error\n"+n)}function vt(n,t,u){function v(t){t-=s,t&&o.push(n.substr(s,t).replace(ii,"\\n"))}function l(t){t&&y('Unmatched or missing tag: "{{/'+t+'}}" in template:\n'+n)}function p(t,a,y,p,b,k,d,g,nt,tt){b&&(p=":",y="html");var rt,it=i,ft=i,ut=!g&&!p&&!u;a=a||p,v(tt),s=tt+t.length,k?w&&o.push(["*",d.replace(kt,"$1")]):a?(a==="else"&&(f[5]=n.substring(f[5],tt),f=e.pop(),o=f[3],ut=r),d=d?bt(d,u).replace(gt,function(n,t,r){return t?ft+=r+c:it+=r+c,i}):i,it=it.slice(0,-1),d=d.slice(0,-1),h=[a,y||i,d,ut&&[],"{"+(it?"props:{"+it+"},":i)+"path:'"+d+"'"+(ft?",ctx:{"+ft.slice(0,-1)+"}":i)+"}"],o.push(h),ut&&(e.push(f),f=h,f[5]=s)):nt&&(rt=f[0],l(nt!==rt&&!(nt==="if"&&rt==="else")&&rt),f[5]=n.substring(f[5],tt),f=e.pop()),l(!f&&nt),o=f[3]}var h,w=t&&t.allowCode,a=[],s=0,e=[],o=a,f=[,,,a];return n=n.replace(dt,"\\$1"),l(e[0]&&e[0][3].pop()[0]),n.replace(g,p),v(n.length),ht(a,t)}function ht(n,t){var f,o,l,u,g,d,nt,it,tt,h,s,e,v,a,w,p,b=t?{allowCode:w=t.allowCode,debug:t.debug}:{},k=t&&t.tmpls,rt=0;for(l=n.length,u=l?i:'"";',o=0;o<l;o++)f=n[o],i+f===f?u+='"'+f+'"+':(h=f[0],h==="*"?u=u.slice(0,o?-1:-3)+";"+f[1]+(o+1<l?"ret+=":i):(s=f[1],e=f[2],p=f[3],v=f[4],markup=f[5],p&&(a=ct(markup,b,t,rt++),ht(f[3],a),k.push(a)),tt=tt||v.indexOf("view")>-1,u+=(h===":"?s==="html"?(d=r,"e("+e):s?(it=r,'c("'+s+'",view,this,'+e):(nt=r,"((v="+e+')!=u?v:""'):(g=r,'t("'+h+'",view,this,"'+(s||i)+'",'+(p?k.length:'""')+c+v+(e?c:i)+e))+")+"));u=oi+(nt?"v,":i)+(g?"t=j._tag,":i)+(it?"c=j._convert,":i)+(d?"e=j.converters.html,":i)+"ret; try{\n\n"+(b.debug?"debugger;":i)+(w?"ret=":"return ")+u.slice(0,-1)+";\n\n"+(w?"return ret;":i)+"}catch(e){return j._err(e);}";try{u=new Function("data, view, j, b, u",u)}catch(ut){y("Compiled template code:\n\n"+u,ut)}return t&&(t.fn=u),u}function bt(n,t){function l(l,a,v,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et){function st(n,t,r,u,f,e,o){if(t){var h,s=(r?'view._hlp("'+r+'")':u?"view":"data")+(o?(f?"."+f:r?i:u?i:"."+t)+(e||i):(o=r?i:u?f||i:t,i));return h=o?"."+o:i,ot||(s=s+h),s=s.slice(0,9)==="view.data"?s.slice(5):s,ot&&(s="b("+s+',"'+o+'")'+h),s}return n}w=w||i,v=v||a||tt,p=p||d,g=g||ft||i,w=w||i;var ot=t&&g!=="(";if(b)y(n);else return f?(f=!it,f?l:'"'):e?(e=!rt,e?l:'"'):(v?(u++,v):i)+(et?u?i:s?(s=h,"\b"):c:k?(u&&y(n),s=r,"\b"+p+":"):p?p.replace(ni,st)+(g?(o[++u]=r,g):w):w?w:ut?(o[u--]=h,ut)+(g?(o[++u]=r,g):i):nt?(o[u]||y(n),c):a?i:(f=it,e=rt,'"'))}var s,o={},u=0,e=h,f=h;return n=(n+" ").replace(ti,l)}function ut(n,r,f,e){function v(t){if(i+t===t||t.nodeType>0){try{h=t.nodeType>0?t:!et.test(t)&&w&&w(t)[0]}catch(r){}if(h){if(!h.type)return;t=o[h.getAttribute(lt)],t||(n=n||"_"+ei++,h.setAttribute(lt,n),t=ut(n,h.innerHTML,f,e),o[n]=t)}return t}}var s,h,c,l,a;if(r=r||i,s=v(r),e=e||(r.markup?r:{}),e.name=n,l=e.templates,!s&&r.markup&&(s=v(r.markup))&&s.fn&&(s.debug!==r.debug||s.allowCode!==r.allowCode)&&(s=s.markup),s!==t){n&&!f&&(rt[n]=function(){return r.render.apply(r,arguments)}),s.fn||r.fn?s.fn&&(r=n&&n!==s.name?u(u({},s),e):s):(r=ct(s,e,f,0),vt(s,r));for(c in l)a=l[c],a.name!==c&&(l[c]=ut(c,a,r));return r}}function ct(n,t,i,r){function e(n){i[n]&&(f[n]=u(u({},i[n]),t[n]))}t=t||{};var f={markup:n,tmpls:[],links:[],render:ft};return i&&(i.templates&&(f.templates=u(u({},i.templates),t.templates)),f.parent=i,f.name=i.name+"["+r+"]",f.key=r),u(f,t),i&&(e("templates"),e("tags"),e("helpers"),e("converters")),f}function pt(n){return st[n]||(st[n]="&#"+n.charCodeAt(0)+";")}var yt="v1.0pre",f,g,et,u,p="{",b="{",s="}",a="}",at={},h=!1,r=!0,w=n.jQuery,ni=/^(?:null|true|false|\d[\d.]*|([\w$]+|~([\w$]+)|#(view|([\w$]+))?)([\w$.]*?)(?:[.[]([\w$]+)\]?)?|(['"]).*\8)$/g,ti=/(\()(?=|\s*\()|(?:([([])\s*)?(?:([#~]?[\w$.]+)?\s*((\+\+|--)|\+|-|&&|\|\||===|!==|==|!=|<=|>=|[<>%*!:?\/]|(=))\s*|([#~]?[\w$.]+)([([])?)|(,\s*)|(\(?)\\?(?:(')|("))|(?:\s*([)\]])([([]?))|(\s+)/g,ii=/\r?\n/g,kt=/\\(['"])/g,dt=/\\?(['"])/g,gt=/\x08(~)?([^\x08]+)\x08/g,ei=0,st={"&":"&amp;","<":"&lt;",">":"&gt;"},lt="data-jsv-tmpl",oi="var j=j||"+(w?"jQuery.":"js")+"views,",wt=/[\x00"&'<>]/g,si=Array.prototype.slice,rt={},e={jsviews:yt,sub:at,debugMode:r,render:rt,templates:o,tags:nt,helpers:v,converters:d,delimiters:ot,View:k,_convert:ui,_err:function(n){return e.debugMode?"Error: "+(n.message||n)+". ":'""'},_tmplFn:vt,_tag:fi,error:l,Error:it};(it.prototype=new Error).constructor=it,w?(f=w,f.templates=o,f.render=rt,f.views=e,f.fn.render=ft):(f=n.jsviews=e,f.extend=function(n,t){var i;n=n||{};for(i in t)n[i]=t[i];return n},f.isArray=Array&&Array.isArray||function(n){return Object.prototype.toString.call(n)==="[object Array]"}),u=f.extend,nt({"if":function(){var r=this,n=r.view;n.onElse=function(r,u){for(var e=0,f=u.length;f&&!u[e++];)if(e===f)return i;return n.onElse=t,r.path=i,r.renderContent(n)};return n.onElse(this,arguments)},"else":function(){var n=this.view;return n.onElse?n.onElse(this,arguments):i},"for":function(){var n,f=this,r=i,u=arguments,t=u.length;for(t===0&&(t=1),n=0;n<t;n++)r+=f.renderContent(u[n]);return r},"*":function(n){return n}}),d({html:function(n){return n!=t?String(n).replace(wt,pt):i}}),ot()}(this);